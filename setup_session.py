"""
–£—Ç–∏–ª–∏—Ç–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ñ–∞–π–ª–∞ —Å–µ—Å—Å–∏–∏ Telegram.

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤ Telegram API.
–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —Å–æ–∑–¥–∞—ë—Ç—Å—è —Ñ–∞–π–ª —Å–µ—Å—Å–∏–∏, –∫–æ—Ç–æ—Ä—ã–π –Ω—É–∂–Ω–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å
–≤ –ø–∞–ø–∫—É /data/ –≤–∞—à–µ–≥–æ –æ–±–ª–∞—á–Ω–æ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, Amvera).

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
    python setup_session.py

–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:
    - Python 3.8+
    - telethon

–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:
    1. –ü–æ–ª—É—á–∏—Ç–µ API_ID –∏ API_HASH –Ω–∞ https://my.telegram.org/
    2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —ç—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç
    3. –í–≤–µ–¥–∏—Ç–µ –≤–∞—à–∏ –¥–∞–Ω–Ω—ã–µ –∏ –∫–æ–¥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
    4. –ó–∞–≥—Ä—É–∑–∏—Ç–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–π —Ñ–∞–π–ª —Å–µ—Å—Å–∏–∏ –≤ /data/ –≤–∞—à–µ–≥–æ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è
"""
from telethon import TelegramClient
import asyncio


async def main():
    """
    –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–µ—Å—Å–∏–∏ Telegram.
    
    –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è API_ID, API_HASH –∏ –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞,
    –ø—Ä–æ–≤–æ–¥–∏—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ñ–∞–π–ª —Å–µ—Å—Å–∏–∏.
    """
    print("=" * 60)
    print("       –£—Ç–∏–ª–∏—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è —Å–µ—Å—Å–∏–∏ Telegram")
    print("=" * 60)
    print()
    print("–≠—Ç–∞ —É—Ç–∏–ª–∏—Ç–∞ –ø–æ–º–æ–∂–µ—Ç –≤–∞–º —Å–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª —Å–µ—Å—Å–∏–∏ –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞.")
    print("–ü–æ–ª—É—á–∏—Ç–µ API_ID –∏ API_HASH –Ω–∞ https://my.telegram.org/")
    print()
    
    # –ó–∞–ø—Ä–æ—Å –¥–∞–Ω–Ω—ã—Ö —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    api_id = input("–í–≤–µ–¥–∏—Ç–µ API_ID: ").strip()
    if not api_id.isdigit():
        print("‚ùå –û—à–∏–±–∫–∞: API_ID –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —á–∏—Å–ª–æ–º")
        return
    
    api_hash = input("–í–≤–µ–¥–∏—Ç–µ API_HASH: ").strip()
    if not api_hash:
        print("‚ùå –û—à–∏–±–∫–∞: API_HASH –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º")
        return
    
    # –ò–º—è —Ñ–∞–π–ª–∞ —Å–µ—Å—Å–∏–∏ (–±–µ–∑ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è .session)
    session_name = "telegram_parser_session"
    
    print()
    print(f"üìÅ –§–∞–π–ª —Å–µ—Å—Å–∏–∏ –±—É–¥–µ—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω –∫–∞–∫: {session_name}.session")
    print()
    
    try:
        # –°–æ–∑–¥–∞—ë–º –∫–ª–∏–µ–Ω—Ç –∏ –ø—Ä–æ–≤–æ–¥–∏–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é
        async with TelegramClient(session_name, int(api_id), api_hash) as client:
            # start() –∑–∞–ø—Ä–æ—Å–∏—Ç –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –∏ –∫–æ–¥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
            await client.start()
            
            # –ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –∞–∫–∫–∞—É–Ω—Ç–µ
            me = await client.get_me()
            
            print()
            print("=" * 60)
            print("‚úÖ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞!")
            print("=" * 60)
            print()
            print(f"   –ê–∫–∫–∞—É–Ω—Ç: {me.first_name or ''} {me.last_name or ''}")
            print(f"   Username: @{me.username}" if me.username else "   Username: –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω")
            print(f"   ID: {me.id}")
            print()
    
    except Exception as e:
        print()
        print(f"‚ùå –û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏: {e}")
        return
    
    # –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
    print("=" * 60)
    print("üì§ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—é:")
    print("=" * 60)
    print()
    print(f"1. –§–∞–π–ª —Å–µ—Å—Å–∏–∏ —Å–æ–∑–¥–∞–Ω: {session_name}.session")
    print()
    print("2. –ó–∞–≥—Ä—É–∑–∏—Ç–µ —ç—Ç–æ—Ç —Ñ–∞–π–ª –≤ –ø–∞–ø–∫—É /data/ –≤–∞—à–µ–≥–æ")
    print("   –æ–±–ª–∞—á–Ω–æ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ (Amvera, VPS –∏ —Ç.–¥.)")
    print()
    print("3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è —É–∫–∞–∑–∞–Ω—ã:")
    print("   - TELEGRAM_API_ID (–≤–∞—à API_ID)")
    print("   - TELEGRAM_API_HASH (–≤–∞—à API_HASH)")
    print()
    print("4. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ")
    print()
    print("=" * 60)
    print("‚ö†Ô∏è  –í–∞–∂–Ω–æ: —Ö—Ä–∞–Ω–∏—Ç–µ —Ñ–∞–π–ª —Å–µ—Å—Å–∏–∏ –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏!")
    print("    –ù–µ –¥–æ–±–∞–≤–ª—è–π—Ç–µ –µ–≥–æ –≤ git-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π.")
    print("=" * 60)


if __name__ == "__main__":
    asyncio.run(main())
